---
title: "Storm analysis"
author: "Tania S.M"
output:
  html_document:
    toc: true
    theme: yeti
    number_sections: true
    highlight: pygments
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.width=10, fig.height=8, fig.path='figures/', dev=c('png'),
                       warning=FALSE, message=FALSE, echo=TRUE)
```

#  Summary 

#  Data Processing 
This section contains details of the data pre-processing used in this study. 

##  Settings (inc. libraries used)

The following libraries were used for data manipulation as well as for visualization purposes:
```{r include =FALSE}
library(dplyr)
library(lubridate)
library(ggplot2)
library(RColorBrewer)
library(grid)
library(scales)
library(R.utils)
#library(data.table)
# library(ggmaps)
```
##  Acquiring the data

The data used in this study can be acquired from the original source (the National Climatic Data Center, National Oceanic and Atmposperic Administration). The file is thenunzipped and read.


```{r}
# Check for existence of the data
if(!file.exists("StormData.csv")) {

# If needed the data is donwloaded from source
download.file(url="https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2", destfile="StormData.csv.bz2")
  
# Unzipping the data 
bunzip2(filename="StormData.csv.bz2", destname = "StormData.csv", remove =  TRUE)
}

# Reading the data set
raw_data <- read.csv("StormData.csv")
```
## Data pre-processing
First we will have a look at the variables included in the data set:
```{r}
# Checking the variables of the data set
names(raw_data)
```


The relevant variables for this study are:

* `EVTYPE`: Type of the event 

- `BGN_DATE`: Start date and time of the storm

- `END_DATE`: End date and time of the storm

- `STATE`: Location of the storm event

- `INJURIES`: Number of injuried per storm

- `FATALITIES`: Number of fatalities per 

- `PROPDMG`: Property damage per storm 

- `PROPDMGEXP`: Character indicating the unit size of PROPDMG

- `CROPDMG`: Crop damage per storm

- `CROPDMGEXP`: Character indicating the unit size of CROPDMG

Hence, only the relevant variables are maintained and kept in a variable named `storm_data`.
```{r}
storm_data <- raw_data %>%  select(EVTYPE, BGN_DATE, END_DATE, STATE, FATALITIES, INJURIES, PROPDMG, PROPDMGEXP, CROPDMG, CROPDMGEXP)
```

Having a look at the data set:
```{r}
head(data)
```
As the magnitude for damages amount contains invalid characters and is not practical in this format for the rest of the analysis, we clean the data and convert it to a numeric value we can multiply with the damage amount to get the final damage value in USD. We consider the invalid characters to be missing data having no value.

The valid values are K for thousands, M for millions and B for billions (as specified in the National Weather Service Storm Data Documentation)



